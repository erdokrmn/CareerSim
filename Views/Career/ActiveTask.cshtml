@model CareerSim.Models.ViewModels.CareerTaskViewModel
@{
    ViewData["Title"] = "Aktif GÃ¶rev";
    Layout = "_UserLayout";
}

<h2>@Model.CareerTitle SimÃ¼lasyonu</h2>

@if (!Model.IsCompleted)
{
    <h3>ðŸ§© GÃ¶rev: @Model.TaskTitle</h3>
    <p>@Model.TaskDescription</p>

    <form asp-action="SubmitAnswer" method="post">
        <input type="hidden" name="CareerId" value="@Model.CareerId" />
        <input type="hidden" name="TaskId" value="@Model.TaskId" />

        <div class="form-group">
            <label for="AnswerText">CevabÄ±nÄ±z:</label>

            <!-- Karakter sayacÄ± -->
            <p><span id="charCount">0</span>/300 karakter</p>

            <!-- KullanÄ±cÄ± cevabÄ± -->
            <textarea id="AnswerText" name="AnswerText" class="form-control" rows="6" maxlength="300" required></textarea>

            <!-- Validasyon mesajÄ± -->
            <span asp-validation-for="AnswerText" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-primary mt-2">GÃ¶nder</button>
    </form>
}
else
{
    <div class="alert alert-success">
        <h4>ðŸŽ‰ TÃ¼m gÃ¶revleri tamamladÄ±nÄ±z!</h4>
        <p>SimÃ¼lasyon sona erdi. Dilerseniz AI deÄŸerlendirmesi alabilirsiniz.</p>

        @if (!string.IsNullOrWhiteSpace(Model.LastAnswerText))
        {
            <h5>Son GÃ¶reve VerdiÄŸiniz Cevap:</h5>
            <pre>@Model.LastAnswerText</pre>
        }

        <a asp-action="EvaluateSummary"
           asp-controller="Career"
           asp-route-careerId="@Model.CareerId"
           class="btn btn-primary">
            TÃ¼m CevaplarÄ± DeÄŸerlendir
        </a>
    </div>
}

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const textarea = document.getElementById("AnswerText");
            const counter = document.getElementById("charCount");

            textarea.addEventListener("input", function () {
                counter.textContent = textarea.value.length;
            });
        });
    </script>
}
